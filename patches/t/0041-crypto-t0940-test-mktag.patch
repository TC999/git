From db10a13696ef89b9ea031789fbaa0244d272481c Mon Sep 17 00:00:00 2001
From: Han Xin <hanxin.hx@alibaba-inc.com>
Date: Wed, 8 Sep 2021 15:30:57 +0800
Subject: [PATCH 41/42] crypto: t0940: test mktag

Add mktag test to ensure that encryption works.

Signed-off-by: Han Xin <hanxin.hx@alibaba-inc.com>
---
 t/t0940/test-1040-mktag.sh | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 t/t0940/test-1040-mktag.sh

diff --git a/t/t0940/test-1040-mktag.sh b/t/t0940/test-1040-mktag.sh
new file mode 100644
index 0000000000..da7b08f2d3
--- /dev/null
+++ b/t/t0940/test-1040-mktag.sh
@@ -0,0 +1,24 @@
+#!/bin/sh
+
+# Test crypto on "git-mktree"
+
+test_expect_success 'setup' '
+	cp -a "$COMMON_GITDIR" bare.git &&
+	cd bare.git &&
+	head=$(git rev-parse --verify HEAD)
+'
+
+cat >tag.sig <<EOF
+object $head
+type commit
+tag mytag
+tagger T A Gger <tagger@example.com> 0 +0000
+
+This is filler
+EOF
+
+test_expect_success 'mktag to create new tag object' '
+	oid=$(git mktag <./tag.sig) &&
+	git cat-file tag $oid > actual &&
+	test_cmp tag.sig actual
+'
-- 
2.34.1.51.g7e1f4e9345.agit.6.5.6

